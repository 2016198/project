#include "Stage.h"
#include "_debug/_DebugConOut.h"
#include"_debug/_DebugDispOut.h"
#include "KeyCheck.h"
#include "DxLib.h"

//マップ、ノーマル
#define MAP_MAZE_X 25
#define MAP_MAZE_Y 25
int mapMaze[MAP_MAZE_X][MAP_MAZE_Y] = {      //マップデータ
	{02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02},
	{02,14,14,14,14, 14,02,15,02,14, 14,14,14,02,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,14,14,02,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,14,14,02,14, 14,34,34,34,34, 34,34,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,02,14,02,14, 14,34,34,34,34, 34,34,14,14,02},

	{02,14,14,14,14, 14,02,14,02,14, 14,02,14,02,14, 14,34,34,34,34, 34,34,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,02,14,02,14, 14,34,34,34,34, 34,34,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,02,14,14,14, 14,34,34,34,34, 34,34,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 14,02,14,14,14, 14,34,34,34,34, 34,34,14,14,02},
	{02,14,14,14,14, 14,02,14,02,14, 02,02,02,02,02, 02,34,34,34,34, 34,34,14,14,02},

	{02,14,14,14,14, 14,02,14,14,14, 02,14,14,14,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 02,14,14,14,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,02,02,02, 02,14,14,02,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,02,14, 14,14,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,02,14, 14,14,14,14,14, 14,14,14,14,02},

	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,02,14, 14,14,02,02,14, 14,02,02,02,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,02,14, 14,02,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,02,14, 14,02,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,02,02, 02,02,02,02,14, 14,02,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,14,14, 14,14,14,14,48, 49,50,14,14,02},

	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,14,14, 14,14,14,14,57, 07,59,14,14,02},
	{02,14,14,14,14, 14,02,14,14,14, 14,14,14,14,14, 14,02,14,14,66, 67,68,14,14,02},
	{02,14,14,14,14, 14,14,14,14,14, 14,14,14,14,14, 14,02,14,14,14, 14,14,14,14,02},
	{02,14,14,14,14, 14,14,14,14,14, 14,14,14,14,14, 14,02,14,14,14, 14,14,14,14,02},
	{02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02, 02,02,02,02,02}

};
//マップ、ノーマル
#define MAP_NORMAL_X MAP_X
#define MAP_NORMAL_Y MAP_Y
int mapNormal[MAP_NORMAL_X][MAP_NORMAL_Y] = {      //マップデータ
		{01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,13,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00, 9,00,00, 00,00, 0,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,18,19,19,19, 19,19,19,19,19, 19,19,19,19,19, 19,19,20,00,01},
		{01,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,00, 0,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00, 9,00,00, 00,00, 9,00,00, 00,00, 0,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00, 0,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,15,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00, 9,00, 00,00,00,00,00, 00,00,00,00,00, 00,24,25,25,25, 25,25,25,25,25, 25,26,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,33,34,34,34, 34,34,34,34,34, 34,35,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,33,34,34,34, 34,34,34,34,34, 34,35,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,33,34,34,34, 34,34,34,34,34, 34,35,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,33,34,34,34, 34,34,34,34,34, 34,35,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00, 9,00, 00,00,00,00,00, 00,33,34,34,34, 34,34,34,34,34, 34,35,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,42,43,43,43, 43,43,43,43,43, 43,44,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,27,28,28,28, 28,28,28,28,28, 28,28,28,28,28, 28,28,29,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,36,37,37,37, 37,37,37,37,37, 37,37,37,37,37, 37,37,38,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 15,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,21,22,22,22, 22,22,22,22,22, 22,23,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,31, 31,32,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,31, 31,32,00,00,00, 00,00,00,00,00, 00,00,00, 9,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,31, 31,32,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,31, 40,41,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,32, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,32, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,32, 00,00,00,00,00, 00,00,00, 9,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,32, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,30,31,31,31, 31,31,31,31,32, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,39,40,40,40, 40,40,40,40,41, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,03, 00,00,03,00,00, 00,00,00,00,00, 00,04,00,00,04, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00, 9,00, 00,00,00,00,00, 00,00,00,00,03, 00,00,03,00,00, 00,00,00,00,00, 04,00,00,00,04, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,03,00, 00,00,00,03,00, 00,00,00,00,04, 00,00,00,04,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,03,00, 11,11,11,11,11, 00,00,00,11,11, 11,11,00,04,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,03,00,00, 00,00,00,00,00, 12,00,00,00,00, 00,00,04,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,03,00,00, 00,00,11,11,00, 00,00,00,00,00, 00,00,04,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,13,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,03,00,00,00, 00,00,11,00,00, 00,00,00,00,00, 00,04,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00, 9,00,00, 00,00,00,00,00, 00,03,00,11,11, 11,11,11,11,11, 00,00,00,00,00, 00,04,00,00,00, 00,00,00,00,01},

		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 03,00,11,00,00, 00,00,00,00,00, 11,00,00,00,00, 04,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 03,00,00,11,11, 11,11,11,11,11, 00,00,00,00,00, 04,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,00, 00,00,00,00,01},
		{01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01, 01,01,01,01,01}
};

bool Stage::Init(int ScreenSizeX, int ScreenSizeY)//インスタンスの生成
{
	mScreenSizeX = ScreenSizeX;
	mScreenSizeY = ScreenSizeY;
	LoadDivGraph("image/map.bmp", 
		CHIP_IMAGE_MAX,
		9,
		9,
		CHIP_SIZE_X,
		CHIP_SIZE_Y,
		&mChipImage[0]);
	if (mChipImage[0] == -1)
	{
		return false;
	}
	SetMap(MAP_ID::NORMAL);
	return true;
}
void Stage::UpDate(void)  //インスタンスの更新
{

}
void Stage::Draw(Vector2 Pos)  // インスタンスの描画
{
	for (int y = 0; y < mMapY; y++)
	{
		for (int x = 0; x < mMapY; x++)
		{
			//チップの表示
			DrawGraph(x * CHIP_SIZE_X - Pos.x, y * CHIP_SIZE_Y - Pos.y, mChipImage[mMap[y][x]], 0);

			//チップ内のメモリ番号の表示
			//DrawFormatString(x * CHIP_SIZE_X + 10 - Pos.x, y * CHIP_SIZE_Y + 10 - Pos.y, GetColor(255, 255, 255), "%d", mMap[y][x]);
		}
	}
}
bool Stage::Release(void)//インスタンスの開放
{
	for (int f = 0; f < CHIP_IMAGE_MAX; f++)
	{
		DeleteGraph(mChipImage[f]);
	}
	return true;
}

int Stage::GetMapChip(Vector2 pos)
{
	//①マップ座標posをマップチップ配列のindexに変換
	//②マップチップ配列の中にあるマップチップ番号を返す。
	return mMap[pos.y / CHIP_SIZE_Y][pos.x / CHIP_SIZE_X];
}

void Stage::SetMap(MAP_ID mapID)	//指定されたマップ情報をマップ配列に格納する
{
	mMapID = mapID;
	for (int x = 0; x < mMapX; x++)
	{
		for (int y = 0; y < mMapY; y++)
		{
			mMap[x][y] = 0;
		}
	}
	switch (mMapID)
	{
	case MAP_ID::NORMAL:
		mMapY = MAP_NORMAL_Y;
		mMapX = MAP_NORMAL_X;
		//マップの初期化
		for (int x = 0; x < mMapX; x++)
		{
			for (int y = 0; y < mMapY; y++)
			{
				mMap[x][y] = mapNormal[x][y];
			}
		}
		break;
	case MAP_ID::MAZE:	
		mMapY = MAP_MAZE_Y;
		mMapX = MAP_MAZE_X;
		for (int x = 0; x < mMapX; x++)
		{
			for (int y = 0; y < mMapY; y++)
			{
				mMap[x][y] = mapMaze[x][y];
			}
		}
		break;
	default:
		break;
	}
}
